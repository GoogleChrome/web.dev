---
layout: post
title: Продуктивність за замовчуванням з Next.js
authors:
  - houssein
subhead: |
  Next.js подбає про оптимізації вашого React додатку, то ж вам не доведеться робити їх власноруч
date: 2019-11-08
---

[Next.js](https://nextjs.org/) широковживаний [React](https://reactjs.org/)
фреймворк з рядом вбудованих оптимізацій додатку. Основна ідея якого
— забезпечити успішний старт програми, а також підтримувати її максимальну
продуктивність без додаткових налаштувань.

У даній статті поверхнево розповідається про фічі, які доступні в Next.js.
Інші гайди цієї серії детальніше досліджують оптимізації продуктивності,
які доступні у фреймворку.

{% Aside %}
Chrome співпрацює з командою Next.js над покращенням фреймворку для розробників, які прагнуть створювати швидкі React додатки з рендерингом на сервері.
Нещодавно, було додано ряд нових оптимізацій,
таких як [module/nomodule support](https://github.com/zeit/next.js/issues/7563)
або [improved granular chunking strategy](https://github.com/zeit/next.js/issues/7631).
{% endAside %}

## Про що ви дізнаєтесь?

Хоча Next.js забезпечує низку оптимізацій продуктивності за замовчуванням, статті нижче мають на меті пояснити їх детальніше, а також показати, як можна застосовувати їх для побудови швидких та продуктивних додатків.

{% Aside %}
Ця серія гайдів передбачає, що у вас є базове розуміння React.
Якщо ж він для вас у новинку, то почніть з [React. Початок роботи](https://reactjs.org/docs/getting-started.html).
{% endAside %}

Існують оптимізації, які можуть бути додані для додатків написаних як на чистому React, так і на Next.js.
Однак, ми не будемо їх розглядати. Основний фокус цієї серії гайдів — показати оптимізації,
які доступні саме з Next.js. Щоб дізнатись загальні рекомендації по оптимізації додатків на React,
читайте [колекцію гайдів по React][collection].

## Чим Next.js відрізняється від React?

Бібліотека React полегшує створення користувацьких інтерфейсів. В її основі закладений
компонентний підхід розробки. Не дивлячись на всю потужність, React покриває лише роботу
з UI. Розробникам доводиться використовувати додаткові тулзи, такі як бандлери
(наприклад [webpack](https://webpack.js.org/)) та транскомпілятори (наприклад [Babel](https://babeljs.io/)),
щоб мати повний набір інструментів для побудови додатку.

В [колекції гайдів по React][collection] ми розглядаємо використання [Create React App](https://create-react-app.dev/) (CRA) для швидкого запуску додатку на React. CRA бере на себе клопіт налаштування проєкту, надаючи повний набір інструментів для білду проєкту з використанням однієї команди.

Хоча CRA і має декілька базових оптимізацій, його основна мета — забезпечити простий
та зрозумілий запуск проєкту на React. Якщо ж необхідно внести додаткові оптимізації,
то в розробника є опція зробити [eject](https://create-react-app.dev/docs/available-scripts#npm-run-eject)
проєкту та внести потрібні налаштування самостійно.

Next.js, який також використовується для створення додатків на React, наслідує інший підхід.
Фреймворк відразу надає ряд загальних оптимізацій, які багато розробників хотіли б мати,
але потребують складного налаштування. Серед них:

- Серверний рендерінг (Server-side rendering)
- Автоматичне розбиття коду (Automatic code-splitting)
- Предзавантаження даних по роутам (Route prefetching)
- Роутинг, який базується на структурі файлової системи (File-system routing)
- Стилізація CSS-in-JS ([`styled-jsx`](https://github.com/zeit/styled-jsx))

## Налаштування проєкту

Виконайте наступну команду, щоб створити новий проєкт з Next.js:

```bash
npx create-next-app new-app
```

{% Aside %}
[npx](https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b)
це package runner, який автоматично встановлюється з npm версії 5.2.0 та вище.
Він спрощує досить багато процесів, пов'язаних з керуванням npm пакетів, включаючи виконання CLI команд (таких як `create-next-app`) без необхідності їх глобального встановлення
на вашому компʼютері.
{% endAside %}

Далі, відкрийте новостворену папку та запустіть сервер розробки:

```bash
cd new-app
npm run dev
```

{% Aside %}
Також, у вас є можливість додати Next.js до вже наявного проєкту з React.
Читайте [Manual Setup](https://nextjs.org/docs#manual-setup), щоб дізнатися як це зробити.
{% endAside %}

Glitch нижче показує структуру папок в новоствореному Next.js проєкті.

{% Instruction 'remix' %}
{% Instruction 'preview' %}

{% Glitch {
  id: 'new-next-app',
  path: 'index.html',
  height: 480
} %}

Слід зазначити, що в створеній папці `pages/` знаходиться лише один файл `index.jsx`.
Next.js слідує підходу роботи з роутингом, який базується на структурі файлової системи.
При такому підході, кожний файл у теці `pages/` виступає окремим роутом додатку.
Додавання нового файлу в цю папку, наприклад `about.js`, автоматично
створює новий роут (`/about`).

Як і в будь-якому іншому React додатку, ми можемо створювати та використовувати компоненти.
В створеному проєкті, є папка `components/` з єдиним компонентом `nav.js`, який імпортується
до файлу `index.js`. За замовчуванням, кожний import, який використовується в Next.js, доставляється після повного
завантаження сторінки, надаючи переваги **автоматичного розбиття коду (Automatic code-splitting)**.

Ба більше, кожна початкова сторінка, яка завантажується завдяки Next.js, **згенерована на сервері (server-side rendered)**.
Відкривши Network panel в DevTools, можна побачити, що початковий запит на документ повертає
повністю згенеровану сторінку.

<figure>
  {% Img src="image/tcFciHGuF3MxnTr1y5ue01OGLBn2/bq2tjbZwvpwqQhFsHp0Q.png", alt="Вкладка Preview в Network panel показує, що Next.js повертає повністю згеноварний HTML код сторінки, після завантаження запиту.", width="800", height="529" %}
  <figcaption>
    Вкладка Preview в Network panel показує, що Next.js повертає повністю згеноварний HTML код сторінки, після завантаження запиту.
  </figcaption>
</figure>

{% Aside %}
Досліджуйте [секцію про серверний рендеринг](https://developers.google.com/web/updates/2019/02/rendering-on-the-web#server-rendering),
щоб дізнатися, як рендеринг на сервері часто покращує роботу користувачів.
{% endAside %}

Ми розглянули лише декілька фіч, які доступні в Next.js за замовчування.
Частина з них, може бути модифікована для покриття різних сценаріїв
використання додатку.

## Що далі?

Якщо хочете дізнатися про окремі фічі Next.js детальніше, то рекомендуємо переглянути наступні статті:

- [Route prefetching](/route-prefetching-in-nextjs/) to speed up page navigations
- [Serving hybrid and AMP-only pages][amp] for faster loading from search engines
- [Code-splitting components with dynamic imports](/code-splitting-with-dynamic-imports-in-nextjs/)
  to reduce JavaScript footprints

[collection]: /react
[cra]: https://create-react-app.dev/
[ssr]: https://developers.google.com/web/updates/2019/02/rendering-on-the-web#server-rendering
[amp]: /how-amp-can-guarantee-fastness-in-your-nextjs-app
