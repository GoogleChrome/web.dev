nombre : Compilación e implementación en GKE

en :
  empujar :
    ramas : [ "principal" ]

env :
  PROJECT_ID : ${{ secretos.GKE_PROJECT }}
  GAR_LOCATION : us-central1 # TODO: actualizar la región del registro de artefactos
  GKE_CLUSTER : clúster-1     # TODO: actualizar el nombre del clúster
  GKE_ZONE : us-central1-c    # TODO: actualizar la zona del clúster
  DEPLOYMENT_NAME : gke-test # TODO: actualizar el nombre de la implementación
  REPOSITORIO : muestras # TODO: actualización del repositorio acoplable de Artifact Registry
  IMAGEN : sitio estático

trabajos :
  configurar-construir-publicar-implementar :
    nombre : Configurar, Construir, Publicar e Implementar
    se ejecuta en : ubuntu-latest
    medio ambiente : producción

    permisos :
      contenido : ' leer '
      id-token : ' escribir '

    pasos :
    - nombre : Caja
      usos : acciones/checkout@v3

    # Configure Workload Identity Federation y genere un token de acceso.
    - id : ' autorización '
      nombre : ' Autenticar en Google Cloud '
      utiliza : ' google-github-actions/auth@v0 '
      con :
        token_format : ' acceso_token '
        workload_identity_provider : ' proyectos/123456789/ubicaciones/global/workloadIdentityPools/mi-grupo/proveedores/mi-proveedor '
        service_account : ' my-service-account@my-project.iam.gserviceaccount.com '
